{"version":3,"sources":["webpack://inspection-scheduler/./node_modules/@arcgis/core/core/accessorSupport/originUtils.js","webpack://inspection-scheduler/./node_modules/@arcgis/core/webdoc/support/saveUtils.js","webpack://inspection-scheduler/./node_modules/@arcgis/core/layers/mixins/SceneService.js","webpack://inspection-scheduler/./node_modules/@arcgis/core/layers/support/I3SLayerDefinitions.js","webpack://inspection-scheduler/./node_modules/@arcgis/core/portal/support/resourceUtils.js"],"names":["r","writtenProperties","forEach","t","target","newOrigin","oldOrigin","updateOrigin","propName","async","s","a","u","resources","h","portalItem","Set","paths","length","i","toKeep","map","resource","path","f","m","delete","push","toUpdate","has","o","content","finish","error","p","n","add","toAdd","e","resourceFromPath","removeResource","catch","l","d","filter","errors","addResource","ok","update","O","T","super","arguments","this","spatialReference","fullExtent","heightModelInfo","minScale","maxScale","version","major","Number","NaN","minor","versionString","copyright","sublayerTitleMode","title","layerId","_debouncedSaveOperations","_save","_saveAs","_readSpatialReference","store","indexCRS","geographicCRS","parseInt","substring","lastIndexOf","extent","Array","isArray","some","U","xmin","ymin","xmax","ymax","toString","split","url","name","_set","_get","_updateExtentFromRootPage","_fetchRootPage","_updateExtentFromRootNode","_fetchRootNode","Math","floor","rootIndex","nodesPerPage","parsedUrl","responseType","signal","data","nodes","obb","center","halfSize","sqrt","zmin","zmax","hasZ","mbs","rootNode","query","test","_fetchFirstLayerId","_fetchServiceLayer","layers","id","ssl","replace","read","origin","validateLayer","load","beforeSave","typeKeywords","getTypeKeywords","indexOf","A","clone","portal","_ensureLoadBeforeSave","type","P","messages","blockedRelativeUrls","pendingOperations","write","_validateAgainstJSONSchema","_updateTypeKeywords","_signIn","user","addItem","item","folder","resourceReferences","itemUrl","message","details","validationOptions","ignoreUnsupported","enabled","E","validate","portalItemLayerType","join","failPolicy","concat","combined","json","origins","service","prototype","readOnly","source","String","isRequired","ignoreOrigin","dependsOn","lodSelectionMetricType","factor","baseColorFactor","baseColorTexture","metallicRoughnessTexture","metallicFactor","roughnessFactor","alphaMode","alphaCutoff","doubleSided","cullFace","normalTexture","occlusionTexture","emissiveTexture","emissiveFactor","pbrMetallicRoughness","opaque","mask","blend","Boolean","none","back","front","reader","index","jpg","png","dds","atlas","y","Float32","UInt64","UInt32","UInt16","UInt8","c","draco","offset","triangle","start","num","sortOrder","sortField","_request","total","nextStart","created","size","Date","hasPath","userItemUrl","FormData","append","access","method","body","deleteAll","slice","Blob"],"mappings":"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","file":"chunks/7586.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isMultiOriginJSONMixin as i}from\"../multiOriginJSONSupportUtils.js\";function r(r){r&&r.writtenProperties&&r.writtenProperties.forEach((r=>{const t=r.target;r.newOrigin&&r.oldOrigin!==r.newOrigin&&i(t)&&t.updateOrigin(r.propName,r.newOrigin)}))}export{r as updateOrigins};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport r from\"../../core/Error.js\";import{generateUUID as e}from\"../../core/uuid.js\";import{eachAlways as o,throwIfAborted as t}from\"../../core/promiseUtils.js\";import{result as s}from\"../../core/asyncUtils.js\";import{getSiblingOfSameTypeI as c}from\"../../portal/support/resourceUtils.js\";async function a(s,a,u){if(!a||!a.resources)return;const h=a.portalItem===s.portalItem?new Set(s.paths):new Set;s.paths.length=0,s.portalItem=a.portalItem;const i=new Set(a.resources.toKeep.map((r=>r.resource.path))),f=new Set,m=[];i.forEach((r=>{h.delete(r),s.paths.push(r)}));for(const r of a.resources.toUpdate)if(h.delete(r.resource.path),i.has(r.resource.path)||f.has(r.resource.path)){const{resource:o,content:t,finish:a,error:p}=r,h=c(o,e());s.paths.push(h.path),m.push(n({resource:h,content:t,finish:a,error:p},u))}else s.paths.push(r.resource.path),m.push(p(r,u)),f.add(r.resource.path);for(const r of a.resources.toAdd)m.push(n(r,u)),s.paths.push(r.resource.path);if(h.forEach((r=>{const e=a.portalItem.resourceFromPath(r);m.push(e.portalItem.removeResource(e).catch((()=>{})))})),0===m.length)return;const l=await o(m);t(u);const d=l.filter((r=>\"error\"in r)).map((r=>r.error));if(d.length>0)throw new r(\"save:resources\",\"Failed to save one or more resources\",{errors:d})}async function n(r,e){const o=await s(r.resource.portalItem.addResource(r.resource,r.content,e));if(!0!==o.ok)throw r.error&&r.error(o.error),o.error;r.finish&&r.finish(r.resource)}async function p(r,e){const o=await s(r.resource.update(r.content,e));if(!0!==o.ok)throw r.error(o.error),o.error;r.finish(r.resource)}export{a as saveResources};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import{isSome as t}from\"../../core/maybe.js\";import r from\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import{reader as i}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as a}from\"../../core/accessorSupport/decorators/writer.js\";import n from\"../../core/Error.js\";import{urlToObject as l,join as p}from\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import{debounce as d,reject as c,all as u}from\"../../core/promiseUtils.js\";import m from\"../../geometry/SpatialReference.js\";import y from\"../../geometry/Extent.js\";import h from\"../../request.js\";import f from\"../../portal/Portal.js\";import v from\"../../portal/PortalItem.js\";import{updateOrigins as g}from\"../../core/accessorSupport/originUtils.js\";import{titleFromUrlAndName as w,parse as S,cleanTitle as I,sanitizeUrlWithLayerId as x,writeUrlWithLayerId as b,isArcGISUrl as j}from\"../support/arcgisLayerUrl.js\";import _ from\"../../geometry/HeightModelInfo.js\";import{saveResources as R}from\"../../webdoc/support/saveUtils.js\";import{url as N}from\"../support/commonProperties.js\";const O=r.getLogger(\"esri.layers.mixins.SceneService\"),T=r=>{let T=class extends r{constructor(){super(...arguments),this.spatialReference=null,this.fullExtent=null,this.heightModelInfo=null,this.minScale=0,this.maxScale=0,this.version={major:Number.NaN,minor:Number.NaN,versionString:\"\"},this.copyright=null,this.sublayerTitleMode=\"item-title\",this.title=null,this.layerId=null,this._debouncedSaveOperations=d((async(e,t,r)=>{switch(e){case 0:return this._save(t);case 1:return this._saveAs(r,t)}}))}readSpatialReference(e,t){return this._readSpatialReference(t)}_readSpatialReference(e){if(null!=e.spatialReference)return m.fromJSON(e.spatialReference);{const t=e.store,r=t.indexCRS||t.geographicCRS,o=r&&parseInt(r.substring(r.lastIndexOf(\"/\")+1,r.length),10);return null!=o?new m(o):null}}readFullExtent(e,t){const r=t.store,o=this._readSpatialReference(t);return null==o||null==r||null==r.extent||!Array.isArray(r.extent)||r.extent.some((e=>e<U))?null:new y({xmin:r.extent[0],ymin:r.extent[1],xmax:r.extent[2],ymax:r.extent[3],spatialReference:o})}readVersion(e,t){const r=t.store,o=null!=r.version?r.version.toString():\"\",i={major:Number.NaN,minor:Number.NaN,versionString:o},s=o.split(\".\");return s.length>=2&&(i.major=parseInt(s[0],10),i.minor=parseInt(s[1],10)),i}readTitlePortalItem(e){return\"item-title\"!==this.sublayerTitleMode?void 0:e}readTitleService(e,r){const o=this.portalItem&&this.portalItem.title;if(\"item-title\"===this.sublayerTitleMode)return w(this.url,r.name);let i=r.name;if(!i&&this.url){const e=S(this.url);t(e)&&(i=e.title)}return\"item-title-and-service-name\"===this.sublayerTitleMode&&o&&(i=o+\" - \"+i),I(i)}set url(e){const t=x(this,e,O);this._set(\"url\",t.url),null!=t.layerId&&this._set(\"layerId\",t.layerId)}writeUrl(e,t,r,o){b(this,e,\"layers\",t,o)}get parsedUrl(){const e=this._get(\"url\");if(!e)return null;const t=l(e);return null!=this.layerId&&j(t.path)&&(t.path=`${t.path}/layers/${this.layerId}`),t}async _verifyRootNodeAndUpdateExtent(e,t){if(e)try{return this._updateExtentFromRootPage(e,await this._fetchRootPage(e,t))}catch(e){}return this._updateExtentFromRootNode(await this._fetchRootNode(t))}async _fetchRootPage(e,t){if(!e)return c();const r=Math.floor(e.rootIndex/e.nodesPerPage),o=`${this.parsedUrl.path}/nodepages/${r}`;return(await h(o,{responseType:\"json\",signal:t})).data}_updateExtentFromRootPage(e,t){if(null==t||null==t.nodes)throw new n(\"sceneservice:invalid-node-page\",\"Inavlid node page.\");const r=t.nodes[e.rootIndex%e.nodesPerPage];if(null==r||null==r.obb||null==r.obb.center||null==r.obb.halfSize)throw new n(\"sceneservice:invalid-node-page\",\"Inavlid node page.\");if(r.obb.center[0]<U)return;const o=r.obb.halfSize,i=r.obb.center[2],s=Math.sqrt(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]);this.fullExtent.zmin=i-s,this.fullExtent.zmax=i+s}_updateExtentFromRootNode(e){if(null==e||null==this.fullExtent||this.fullExtent.hasZ)return;if(!Array.isArray(e.mbs)||4!==e.mbs.length||e.mbs[0]<U)return;const t=e.mbs[2],r=e.mbs[3];this.fullExtent.zmin=t-r,this.fullExtent.zmax=t+r}async _fetchRootNode(e){if(!this.rootNode)return;const t=p(this.parsedUrl.path,this.rootNode);try{return(await h(t,{query:{f:\"json\"},responseType:\"json\",signal:e})).data}catch(e){throw new n(\"sceneservice:root-node-missing\",\"Root node missing.\",{error:e,url:t})}}async _fetchService(e){if(null==this.layerId&&/SceneServer\\/*$/i.test(this.url)){const t=await this._fetchFirstLayerId(e);null!=t&&(this.layerId=t)}return this._fetchServiceLayer(e)}async _fetchFirstLayerId(e){const t=await h(this.url,{query:{f:\"json\"},responseType:\"json\",signal:e});if(t.data&&Array.isArray(t.data.layers)&&t.data.layers.length>0)return t.data.layers[0].id}async _fetchServiceLayer(e){const t=await h(this.parsedUrl.path,{query:{f:\"json\"},responseType:\"json\",signal:e});t.ssl&&(this.url=this.url.replace(/^http:/i,\"https:\"));const r=t.data;this.read(r,{origin:\"service\",url:this.parsedUrl}),this.validateLayer(r)}async _ensureLoadBeforeSave(){await this.load(),\"beforeSave\"in this&&\"function\"==typeof this.beforeSave&&await this.beforeSave()}validateLayer(e){}_updateTypeKeywords(e,t,r){e.typeKeywords||(e.typeKeywords=[]);const o=t.getTypeKeywords();for(const t of o)e.typeKeywords.push(t);e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)),1===r&&(e.typeKeywords=e.typeKeywords.filter((e=>\"Hosted Service\"!==e))))}async _saveAs(e,t){const r={...A,...t};let o=v.from(e);o||(O.error(\"_saveAs(): requires a portal item parameter\"),await c(new n(\"sceneservice:portal-item-required\",\"_saveAs() requires a portal item to save to\"))),o.id&&(o=o.clone(),o.id=null);const i=o.portal||f.getDefault();await this._ensureLoadBeforeSave(),o.type=P,o.portal=i;const s={origin:\"portal-item\",url:null,messages:[],portal:i,portalItem:o,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},a={layers:[this.write(null,s)]};return await u(s.resources.pendingOperations),await this._validateAgainstJSONSchema(a,s,r),o.url=this.url,o.title||(o.title=this.title),this._updateTypeKeywords(o,r,1),await i._signIn(),await i.user.addItem({item:o,folder:r&&r.folder,data:a}),await R(this.resourceReferences,s,null),this.portalItem=o,g(s),s.portalItem=o,o}async _save(e){const t={...A,...e};this.portalItem||(O.error(\"_save(): requires the .portalItem property to be set\"),await c(new n(\"sceneservice:portal-item-not-set\",\"Portal item to save to has not been set on this SceneService\"))),this.portalItem.type!==P&&(O.error(\"_save(): Non-matching portal item type. Got \"+this.portalItem.type+\", expected \"+P),await c(new n(\"sceneservice:portal-item-wrong-type\",`Portal item needs to have type \"${P}\"`))),await this._ensureLoadBeforeSave();const r={origin:\"portal-item\",url:this.portalItem.itemUrl&&l(this.portalItem.itemUrl),messages:[],portal:this.portalItem.portal||f.getDefault(),portalItem:this.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},o={layers:[this.write(null,r)]};return await u(r.resources.pendingOperations),await this._validateAgainstJSONSchema(o,r,t),this.portalItem.url=this.url,this.portalItem.title||(this.portalItem.title=this.title),this._updateTypeKeywords(this.portalItem,t,0),await this.portalItem.update({data:o}),await R(this.resourceReferences,r,null),g(r),this.portalItem}async _validateAgainstJSONSchema(e,t,r){let o=t.messages.filter((e=>\"error\"===e.type)).map((e=>new n(e.name,e.message,e.details)));if(r&&r.validationOptions.ignoreUnsupported&&(o=o.filter((e=>\"layer:unsupported\"!==e.name&&\"symbol:unsupported\"!==e.name&&\"symbol-layer:unsupported\"!==e.name&&\"property:unsupported\"!==e.name&&\"url:unsupported\"!==e.name&&\"scenemodification:unsupported\"!==e.name))),r.validationOptions.enabled||E){const t=(await import(\"../support/schemaValidator.js\")).validate(e,r.portalItemLayerType);if(t.length>0){const e=`Layer item did not validate:\\n${t.join(\"\\n\")}`;if(O.error(`_validateAgainstJSONSchema(): ${e}`),\"throw\"===r.validationOptions.failPolicy){const e=t.map((e=>new n(\"sceneservice:schema-validation\",e))).concat(o);throw new n(\"sceneservice-validate:error\",\"Failed to save layer item due to schema validation, see `details.errors`.\",{combined:e})}}}if(o.length>0)throw new n(\"sceneservice:save\",\"Failed to save SceneService due to unsupported or invalid content. See 'details.errors' for more detailed information\",{errors:o})}};return e([o({json:{origins:{service:{read:!1},\"portal-item\":{read:!1}}}})],T.prototype,\"id\",void 0),e([o({type:m})],T.prototype,\"spatialReference\",void 0),e([i(\"spatialReference\",[\"spatialReference\",\"store.indexCRS\",\"store.geographicCRS\"])],T.prototype,\"readSpatialReference\",null),e([o({type:y})],T.prototype,\"fullExtent\",void 0),e([i(\"fullExtent\",[\"store.extent\",\"spatialReference\",\"store.indexCRS\",\"store.geographicCRS\"])],T.prototype,\"readFullExtent\",null),e([o({readOnly:!0,type:_})],T.prototype,\"heightModelInfo\",void 0),e([o({type:Number,json:{name:\"layerDefinition.minScale\",write:!0,origins:{service:{read:{source:\"minScale\"},write:!1}}}})],T.prototype,\"minScale\",void 0),e([o({type:Number,json:{name:\"layerDefinition.maxScale\",write:!0,origins:{service:{read:{source:\"maxScale\"},write:!1}}}})],T.prototype,\"maxScale\",void 0),e([o({readOnly:!0})],T.prototype,\"version\",void 0),e([i(\"version\",[\"store.version\"])],T.prototype,\"readVersion\",null),e([o({type:String,json:{read:{source:\"copyrightText\"}}})],T.prototype,\"copyright\",void 0),e([o({type:String,json:{read:!1}})],T.prototype,\"sublayerTitleMode\",void 0),e([o({type:String})],T.prototype,\"title\",void 0),e([i(\"portal-item\",\"title\")],T.prototype,\"readTitlePortalItem\",null),e([i(\"service\",\"title\",[\"name\"])],T.prototype,\"readTitleService\",null),e([o({type:Number,json:{origins:{service:{read:{source:\"id\"}},\"portal-item\":{write:{target:\"id\",isRequired:!0,ignoreOrigin:!0},read:!1}}}})],T.prototype,\"layerId\",void 0),e([o(N)],T.prototype,\"url\",null),e([a(\"url\")],T.prototype,\"writeUrl\",null),e([o({dependsOn:[\"layerId\"]})],T.prototype,\"parsedUrl\",null),e([o({readOnly:!0})],T.prototype,\"store\",void 0),e([o({type:String,readOnly:!0,json:{read:{source:\"store.rootNode\"}}})],T.prototype,\"rootNode\",void 0),T=e([s(\"esri.layers.mixins.SceneService\")],T),T},U=-1e38,E=!1,P=\"Scene Service\",A={getTypeKeywords:()=>[],portalItemLayerType:\"unknown\",validationOptions:{enabled:!0,ignoreUnsupported:!1,failPolicy:\"throw\"}};export{P as SCENE_SERVICE_ITEM_TYPE,T as SceneService};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import{enumeration as o}from\"../../core/accessorSupport/decorators/enumeration.js\";import{subclass as r}from\"../../core/accessorSupport/decorators/subclass.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import{JSONSupport as p}from\"../../core/JSONSupport.js\";let s=class extends p{constructor(){super(...arguments),this.nodesPerPage=null,this.rootIndex=0,this.lodSelectionMetricType=null}};e([t({type:Number})],s.prototype,\"nodesPerPage\",void 0),e([t({type:Number})],s.prototype,\"rootIndex\",void 0),e([t({type:String})],s.prototype,\"lodSelectionMetricType\",void 0),s=e([r(\"esri.layer.support.I3SNodePageDefinition\")],s);let i=class extends p{constructor(){super(...arguments),this.factor=1}};e([t({type:Number,json:{read:{source:\"textureSetDefinitionId\"}}})],i.prototype,\"id\",void 0),e([t({type:Number})],i.prototype,\"factor\",void 0),i=e([r(\"esri.layer.support.I3SMaterialTexture\")],i);let l=class extends p{constructor(){super(...arguments),this.baseColorFactor=[1,1,1,1],this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.metallicFactor=1,this.roughnessFactor=1}};e([t({type:[Number]})],l.prototype,\"baseColorFactor\",void 0),e([t({type:i})],l.prototype,\"baseColorTexture\",void 0),e([t({type:i})],l.prototype,\"metallicRoughnessTexture\",void 0),e([t({type:Number})],l.prototype,\"metallicFactor\",void 0),e([t({type:Number})],l.prototype,\"roughnessFactor\",void 0),l=e([r(\"esri.layer.support.I3SMaterialPBRMetallicRoughness\")],l);let a=class extends p{constructor(){super(...arguments),this.alphaMode=\"opaque\",this.alphaCutoff=.25,this.doubleSided=!1,this.cullFace=\"none\",this.normalTexture=null,this.occlusionTexture=null,this.emissiveTexture=null,this.emissiveFactor=null,this.pbrMetallicRoughness=null}};e([o({opaque:\"opaque\",mask:\"mask\",blend:\"blend\"})],a.prototype,\"alphaMode\",void 0),e([t({type:Number})],a.prototype,\"alphaCutoff\",void 0),e([t({type:Boolean})],a.prototype,\"doubleSided\",void 0),e([o({none:\"none\",back:\"back\",front:\"front\"})],a.prototype,\"cullFace\",void 0),e([t({type:i})],a.prototype,\"normalTexture\",void 0),e([t({type:i})],a.prototype,\"occlusionTexture\",void 0),e([t({type:i})],a.prototype,\"emissiveTexture\",void 0),e([t({type:[Number]})],a.prototype,\"emissiveFactor\",void 0),e([t({type:l})],a.prototype,\"pbrMetallicRoughness\",void 0),a=e([r(\"esri.layer.support.I3SMaterialDefinition\")],a);let n=class extends p{};e([t({type:String,json:{read:{source:[\"name\",\"index\"],reader:(e,t)=>null!=e?e:`${t.index}`}}})],n.prototype,\"name\",void 0),e([o({jpg:\"jpg\",png:\"png\",dds:\"dds\",\"ktx-etc2\":\"ktx-etc2\"})],n.prototype,\"format\",void 0),n=e([r(\"esri.layer.support.I3STextureFormat\")],n);let u=class extends p{constructor(){super(...arguments),this.atlas=!1}};e([t({type:[n]})],u.prototype,\"formats\",void 0),e([t({type:Boolean})],u.prototype,\"atlas\",void 0),u=e([r(\"esri.layer.support.I3STextureSetDefinition\")],u);let y=class extends p{};e([o({Float32:\"Float32\",UInt64:\"UInt64\",UInt32:\"UInt32\",UInt16:\"UInt16\",UInt8:\"UInt8\"})],y.prototype,\"type\",void 0),e([t({type:Number})],y.prototype,\"component\",void 0),y=e([r(\"esri.layer.support.I3SGeometryAttribute\")],y);let c=class extends p{};e([o({draco:\"draco\"})],c.prototype,\"encoding\",void 0),e([t({type:[String]})],c.prototype,\"attributes\",void 0),c=e([r(\"esri.layer.support.I3SGeometryCompressedAttributes\")],c);let d=class extends p{constructor(){super(...arguments),this.offset=0}};e([t({type:Number})],d.prototype,\"offset\",void 0),e([t({type:y})],d.prototype,\"position\",void 0),e([t({type:y})],d.prototype,\"normal\",void 0),e([t({type:y})],d.prototype,\"uv0\",void 0),e([t({type:y})],d.prototype,\"color\",void 0),e([t({type:y})],d.prototype,\"uvRegion\",void 0),e([t({type:y})],d.prototype,\"featureId\",void 0),e([t({type:y})],d.prototype,\"faceRange\",void 0),e([t({type:c})],d.prototype,\"compressedAttributes\",void 0),d=e([r(\"esri.layer.support.I3SGeometryBuffer\")],d);let m=class extends p{};e([o({triangle:\"triangle\"})],m.prototype,\"topology\",void 0),e([t()],m.prototype,\"geometryBuffers\",void 0),m=e([r(\"esri.layer.support.I3SGeometryDefinition\")],m);export{y as I3SGeometryAttribute,d as I3SGeometryBuffer,c as I3SGeometryCompressedAttributes,m as I3SGeometryDefinition,a as I3SMaterialDefinition,l as I3SMaterialPBRMetallicRoughness,i as I3SMaterialTexture,s as I3SNodePageDefinition,n as I3STextureFormat,u as I3STextureSetDefinition};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{get as e,isSome as t,isNone as r}from\"../../core/maybe.js\";import a from\"../../core/Error.js\";import{join as o,getPathExtension as s}from\"../../core/urlUtils.js\";import n from\"../../request.js\";async function u(t,r={},a){await t.load(a);const s=o(t.itemUrl,\"resources\"),{start:n=1,num:u=10,sortOrder:c=\"asc\",sortField:i=\"created\"}=r,l={query:{start:n,num:u,sortOrder:c,sortField:i},signal:e(a,\"signal\")},p=await t.portal._request(s,l);return{total:p.total,nextStart:p.nextStart,resources:p.resources.map((({created:e,size:r,resource:a})=>({created:new Date(e),size:r,resource:t.resourceFromPath(a)})))}}async function c(r,s,n,u){if(!r.hasPath())throw new a(`portal-item-resource-${s}:invalid-path`,\"Resource does not have a valid path\");await r.portalItem.load(u);const c=o(r.portalItem.userItemUrl,\"add\"===s?\"addResources\":\"updateResources\"),[i,l]=p(r.path),m=await d(n),h=new FormData;return i&&\".\"!==i&&h.append(\"resourcesPrefix\",i),h.append(\"fileName\",l),h.append(\"file\",m,l),h.append(\"f\",\"json\"),t(u)&&u.access&&h.append(\"access\",u.access),await r.portalItem.portal._request(c,{method:\"post\",body:h,signal:e(u,\"signal\")}),r}async function i(t,r,s){if(!r.hasPath())throw new a(\"portal-item-resources-remove:invalid-path\",\"Resource does not have a valid path\");await t.load(s);const n=o(t.userItemUrl,\"removeResources\");await t.portal._request(n,{method:\"post\",query:{resource:r.path},signal:e(s,\"signal\")}),r.portalItem=null}async function l(t,r){await t.load(r);const a=o(t.userItemUrl,\"removeResources\");return t.portal._request(a,{method:\"post\",query:{deleteAll:!0},signal:e(r,\"signal\")})}function p(e){const t=e.lastIndexOf(\"/\");return-1===t?[\".\",e]:[e.slice(0,t),e.slice(t+1)]}function m(e){const[t,a]=function(e){const t=s(e);if(r(t))return[e,\"\"];return[e.slice(0,e.length-t.length-1),`.${t}`]}(e),[o,n]=p(t);return[o,n,a]}async function d(e){if(e instanceof Blob)return e;return(await n(e.url,{responseType:\"blob\"})).data}function h(e,t){if(!e.hasPath())return null;const[r,,a]=m(e.path);return e.portalItem.resourceFromPath(o(r,t+a))}function f(e,t){if(!e.hasPath())return null;const[r,,a]=m(e.path);return e.portalItem.resourceFromPath(o(r,t+a))}export{c as addOrUpdateResource,d as contentToBlob,u as fetchResources,h as getSiblingOfSameType,f as getSiblingOfSameTypeI,l as removeAllResources,i as removeResource,m as splitPrefixFileNameAndExtension};\n"],"sourceRoot":""}
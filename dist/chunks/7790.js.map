{"version":3,"sources":["webpack://inspection-scheduler/./node_modules/@arcgis/core/views/3d/support/WorkerHandle.js","webpack://inspection-scheduler/./node_modules/@arcgis/core/layers/support/LercDecoder.js","webpack://inspection-scheduler/./node_modules/@arcgis/core/layers/ElevationLayer.js"],"names":["o","t","r","e","s","this","_methodName","_promise","scheduler","then","_thread","hasInitialize","broadcast","close","catch","error","getTransferList","invoke","transferList","signal","super","strategy","n","byteLength","buffer","options","Map","x","T","copyright","heightModelInfo","path","opacity","operationalLayerType","sourceJSON","type","url","version","_lercDecoder","get","instance","ref","set","destroy","delete","constructed","warn","declaredClass","currentVersion","addResolvingPromise","loadFromPortal","supportedTypes","supportsData","validateItem","typeKeywords","length","toLowerCase","expectedType","_fetchImageService","i","a","responseType","l","noDataValue","returnFileInfo","load","_fetchTileAvailability","getTileUrl","decode","data","values","pixelData","width","height","maxZError","fileInfo","minValue","maxValue","tilemapCache","supportsBlankTile","parsedUrl","query","blankTile","ElevationQuery","createSampler","fetchAvailability","f","ssl","replace","read","origin","json","source","prototype","readOnly","String","origins","write","service","value"],"mappings":"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","file":"chunks/7790.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport t from\"../../../core/Logger.js\";import{throwIfAborted as r,reject as e,all as s}from\"../../../core/promiseUtils.js\";import{open as i}from\"../../../core/workers/workers.js\";const o=t.getLogger(\"esri.views.3d.support.WorkerHandle\");class h{constructor(t,r,e,s={}){this._methodName=r,this._promise=i(t,{...s,scheduler:e}).then((t=>{void 0===this._thread?(this._thread=t,this._promise=null,s.hasInitialize&&this.broadcast({},\"initialize\")):t.close()})),this._promise.catch((r=>o.error(`Failed to initialize ${t} worker: ${r}`)))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}invoke(t,s){if(this._thread){const r=this.getTransferList(t);return this._thread.invoke(this._methodName,t,{transferList:r,signal:s})}return this._promise?this._promise.then((()=>(r(s),this.invoke(t,s)))):e(null)}broadcast(t,r){return this._thread?s(this._thread.broadcast(r,t)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(t,r))):e()}get promise(){return this._promise}}export{h as WorkerHandle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{resolve as e}from\"../../core/promiseUtils.js\";import{WorkerHandle as r}from\"../../views/3d/support/WorkerHandle.js\";class t extends r{constructor(e){super(\"LercWorker\",\"_decode\",e,{strategy:\"dedicated\"}),this.scheduler=e}decode(r,t,n){return r&&0!==r.byteLength?this.invoke({buffer:r,options:t},n):e(null)}getTransferList(e){return[e.buffer]}}const n=new Map;function s(e){let r=n.get(e);return r||(r={instance:new t(e),ref:0},n.set(e,r)),++r.ref,r.instance}function o(e){if(null==e)return;const r=e.scheduler,t=n.get(r);t&&--t.ref<=0&&(t.instance.destroy(),n.delete(r))}export{s as acquireDecoder,o as releaseDecoder};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import{isSome as r}from\"../core/maybe.js\";import t from\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{property as o}from\"../core/accessorSupport/decorators/property.js\";import{reader as i}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as s}from\"../core/accessorSupport/decorators/subclass.js\";import a from\"../core/Error.js\";import{objectToQuery as l}from\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{resolve as n,createAbortController as p,throwIfAborted as c}from\"../core/promiseUtils.js\";import m from\"../request.js\";import u from\"./Layer.js\";import{MultiOriginJSONMixin as d}from\"../core/MultiOriginJSONSupport.js\";import h from\"../geometry/HeightModelInfo.js\";import{url as y}from\"./support/commonProperties.js\";import{OperationalLayer as v}from\"./mixins/OperationalLayer.js\";import{ArcGISService as g}from\"./mixins/ArcGISService.js\";import{PortalLayer as f}from\"./mixins/PortalLayer.js\";import{ArcGISCachedService as S}from\"./mixins/ArcGISCachedService.js\";import{acquireDecoder as j,releaseDecoder as w}from\"./support/LercDecoder.js\";const x=t.getLogger(\"esri.layers.ElevationLayer\");let T=class extends(S(g(v(f(d(u)))))){constructor(...e){super(...e),this.copyright=null,this.heightModelInfo=null,this.path=null,this.opacity=1,this.operationalLayerType=\"ArcGISTiledElevationServiceLayer\",this.sourceJSON=null,this.type=\"elevation\",this.url=null,this.version=null,this._lercDecoder=j()}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}destroy(){w(this._lercDecoder),this._lercDecoder=null}set minScale(e){this.constructed&&x.warn(`${this.declaredClass}.minScale support has been removed (since 4.5)`)}get minScale(){}set maxScale(e){this.constructed&&x.warn(`${this.declaredClass}.maxScale support has been removed (since 4.5)`)}get maxScale(){}readVersion(e,r){let t=r.currentVersion;return t||(t=9.3),t}load(e){const t=r(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Image Service\"],supportsData:!1,validateItem:e=>{for(let r=0;r<e.typeKeywords.length;r++)if(\"elevation 3d layer\"===e.typeKeywords[r].toLowerCase())return!0;throw new a(\"portal:invalid-layer-item-type\",\"Invalid layer item type '${type}', expected '${expectedType}' \",{type:\"Image Service\",expectedType:\"Image Service Elevation 3D Layer\"})}},e).then((()=>this._fetchImageService(t)),(()=>this._fetchImageService(t)))),n(this)}fetchTile(e,t,o,i){const s=r((i=i||{signal:null}).signal)?i.signal:i.signal=p().signal,a={responseType:\"array-buffer\",signal:s},l={noDataValue:i.noDataValue,returnFileInfo:!0};return this.load().then((()=>this._fetchTileAvailability(e,t,o,i))).then((()=>m(this.getTileUrl(e,t,o),a))).then((e=>this._lercDecoder.decode(e.data,l,s))).then((e=>({values:e.pixelData,width:e.width,height:e.height,maxZError:e.fileInfo.maxZError,noDataValue:e.noDataValue,minValue:e.minValue,maxValue:e.maxValue})))}getTileUrl(e,r,t){const o=!this.tilemapCache&&this.supportsBlankTile,i=l({...this.parsedUrl.query,blankTile:!o&&null});return`${this.parsedUrl.path}/tile/${e}/${r}/${t}${i?\"?\"+i:\"\"}`}async queryElevation(e,r){const{ElevationQuery:t}=await import(\"./support/ElevationQuery.js\");c(r);return(new t).query(this,e,r)}async createElevationSampler(e,r){const{ElevationQuery:t}=await import(\"./support/ElevationQuery.js\");c(r);return(new t).createSampler(this,e,r)}_fetchTileAvailability(e,r,t,o){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,r,t,o):n(\"unknown\")}async _fetchImageService(e){if(this.sourceJSON)return this.sourceJSON;const r={query:{f:\"json\",...this.parsedUrl.query},responseType:\"json\",signal:e},t=await m(this.parsedUrl.path,r);t.ssl&&(this.url=this.url.replace(/^http:/i,\"https:\")),this.sourceJSON=t.data,this.read(t.data,{origin:\"service\",url:this.parsedUrl})}};e([o({json:{read:{source:\"copyrightText\"}}})],T.prototype,\"copyright\",void 0),e([o({readOnly:!0,type:h})],T.prototype,\"heightModelInfo\",void 0),e([o({type:String,json:{origins:{\"web-scene\":{read:!0,write:!0}},read:!1}})],T.prototype,\"path\",void 0),e([o({type:[\"show\",\"hide\"]})],T.prototype,\"listMode\",void 0),e([o({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},\"portal-item\":{read:!1,write:!1},\"web-document\":{read:!1,write:!1}}}})],T.prototype,\"minScale\",null),e([o({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},\"portal-item\":{read:!1,write:!1},\"web-document\":{read:!1,write:!1}}}})],T.prototype,\"maxScale\",null),e([o({json:{read:!1,write:!1,origins:{\"web-document\":{read:!1,write:!1}}}})],T.prototype,\"opacity\",void 0),e([o({type:[\"ArcGISTiledElevationServiceLayer\"]})],T.prototype,\"operationalLayerType\",void 0),e([o()],T.prototype,\"sourceJSON\",void 0),e([o({json:{read:!1},value:\"elevation\",readOnly:!0})],T.prototype,\"type\",void 0),e([o(y)],T.prototype,\"url\",void 0),e([o()],T.prototype,\"version\",void 0),e([i(\"version\",[\"currentVersion\"])],T.prototype,\"readVersion\",null),T=e([s(\"esri.layers.ElevationLayer\")],T);var I=T;export default I;\n"],"sourceRoot":""}
{"version":3,"sources":["webpack://inspection-scheduler/./node_modules/@arcgis/core/layers/TileLayer.js"],"names":["M","N","e","super","this","listMode","isReference","operationalLayerType","resampling","sourceJSON","spatialReference","path","sublayers","type","url","r","t","signal","addResolvingPromise","loadFromPortal","supportedTypes","then","_fetchService","parsedUrl","toLowerCase","_getDefaultAttribution","_getMapName","tileInfo","s","loaded","o","slice","reverse","flatten","toArray","i","a","writeSublayerStructure","forEach","write","push","some","Object","keys","length","layers","_getDefaultTileServers","Array","isArray","map","timestamp","getTileUrl","l","responseType","query","_ts","data","tilemapCache","supportsBlankTile","blankTile","customParameters","tileServers","bandCount","pixelSizeX","serverType","f","ssl","replace","read","origin","version","_fetchServerVersion","currentVersion","catch","match","indexOf","search","readOnly","dependsOn","prototype","Boolean","json","enabled","overridePolicy","String","origins"],"mappings":"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","file":"chunks/6416.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import{isSome as r}from\"../core/maybe.js\";import\"../core/Logger.js\";import{property as t}from\"../core/accessorSupport/decorators/property.js\";import{cast as s}from\"../core/accessorSupport/decorators/cast.js\";import{reader as o}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as i}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as a}from\"../core/accessorSupport/decorators/writer.js\";import l from\"../core/Error.js\";import{urlToObject as n,objectToQuery as p,makeAbsolute as c}from\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{resolve as u,create as m,reject as d}from\"../core/promiseUtils.js\";import h from\"../geometry/SpatialReference.js\";import\"../geometry.js\";import y from\"../request.js\";import f from\"./Layer.js\";import{MultiOriginJSONMixin as v}from\"../core/MultiOriginJSONSupport.js\";import{parse as g,isHostedAgolService as S,isArcGISUrl as _}from\"./support/arcgisLayerUrl.js\";import{url as j}from\"./support/commonProperties.js\";import{OperationalLayer as b}from\"./mixins/OperationalLayer.js\";import{ArcGISService as O}from\"./mixins/ArcGISService.js\";import{BlendLayer as w}from\"./mixins/BlendLayer.js\";import{CustomParametersMixin as T}from\"./mixins/CustomParametersMixin.js\";import{PortalLayer as L}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as R}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as U}from\"./mixins/ScaleRangeLayer.js\";import{HandleOwnerMixin as x}from\"../core/HandleOwner.js\";import{ArcGISCachedService as W}from\"./mixins/ArcGISCachedService.js\";import{ArcGISMapService as A}from\"./mixins/ArcGISMapService.js\";import C from\"./support/Sublayer.js\";import{SublayersOwner as I}from\"./mixins/SublayersOwner.js\";const M=[\"Canvas/World_Dark_Gray_Base\",\"Canvas/World_Dark_Gray_Reference\",\"Canvas/World_Light_Gray_Base\",\"Canvas/World_Light_Gray_Reference\",\"Elevation/World_Hillshade\",\"Elevation/World_Hillshade_Dark\",\"Ocean/World_Ocean_Base\",\"Ocean/World_Ocean_Reference\",\"Ocean_Basemap\",\"Reference/World_Boundaries_and_Places\",\"Reference/World_Boundaries_and_Places_Alternate\",\"Reference/World_Transportation\",\"World_Imagery\",\"World_Street_Map\",\"World_Topo_Map\"];let N=class extends(w(I(U(R(b(L(W(A(O(v(x(T(f))))))))))))){constructor(...e){super(...e),this.listMode=\"show\",this.isReference=null,this.operationalLayerType=\"ArcGISTiledMapServiceLayer\",this.resampling=!0,this.sourceJSON=null,this.spatialReference=null,this.path=null,this.sublayers=null,this.type=\"tile\",this.url=null}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}load(e){const t=r(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Map Service\"]},e).then((()=>this._fetchService(t)),(()=>this._fetchService(t)))),u(this)}get attributionDataUrl(){var e;const r=null==(e=this.parsedUrl)?void 0:e.path.toLowerCase();return r&&this._getDefaultAttribution(this._getMapName(r))}readSpatialReference(e,r){return(e=e||r.tileInfo&&r.tileInfo.spatialReference)&&h.fromJSON(e)}writeSublayers(e,r,t,s){if(!this.loaded||!e)return;const o=e.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).toArray(),i=[],a={writeSublayerStructure:!1,...s};o.forEach((e=>{const r=e.write({},a);i.push(r)}));i.some((e=>Object.keys(e).length>1))&&(r.layers=i)}get tileServers(){return this._getDefaultTileServers(this.parsedUrl.path)}castTileServers(e){return Array.isArray(e)?e.map((e=>n(e).path)):null}fetchTile(e,r,t,s={}){const{signal:o,timestamp:i}=s,a=this.getTileUrl(e,r,t),l={responseType:\"image\",signal:o};return null!=i&&(l.query={_ts:s.timestamp}),y(a,l).then((e=>e.data))}getTileUrl(e,r,t){const s=!this.tilemapCache&&this.supportsBlankTile,o=p({...this.parsedUrl.query,blankTile:!s&&null,...this.customParameters}),i=this.tileServers;return`${i&&i.length?i[r%i.length]:this.parsedUrl.path}/tile/${e}/${r}/${t}${o?\"?\"+o:\"\"}`}_fetchService(e){return m(((t,s)=>{if(this.sourceJSON){if(null!=this.sourceJSON.bandCount&&null!=this.sourceJSON.pixelSizeX)throw new l(\"tile-layer:unsupported-url\",\"use ImageryTileLayer to open a tiled image service\");return void t({data:this.sourceJSON})}if(!this.parsedUrl)throw new l(\"tile-layer:undefined-url\",\"layer's url is not defined\");const o=g(this.parsedUrl.path);if(r(o)&&\"ImageServer\"===o.serverType)throw new l(\"tile-layer:unsupported-url\",\"use ImageryTileLayer to open a tiled image service\");y(this.parsedUrl.path,{query:{f:\"json\",...this.parsedUrl.query,...this.customParameters},responseType:\"json\",signal:e}).then(t,s)})).then((r=>{if(r.ssl&&(this.url=this.url.replace(/^http:/i,\"https:\")),this.sourceJSON=r.data,this.read(r.data,{origin:\"service\",url:this.parsedUrl}),10.1===this.version&&!S(this.url))return this._fetchServerVersion(this.url,e).then((e=>{this.read({currentVersion:e})})).catch((()=>{}))}))}_fetchServerVersion(e,r){if(!_(e))return d();const t=e.replace(/(.*\\/rest)\\/.*/i,\"$1\")+\"/info\";return y(t,{query:{f:\"json\",...this.customParameters},responseType:\"json\",signal:r}).then((e=>{if(e.data&&e.data.currentVersion)return e.data.currentVersion;throw new l(\"tile-layer:version-not-available\")}))}_getMapName(e){const r=e.match(/^(?:https?:)?\\/\\/(server\\.arcgisonline\\.com|services\\.arcgisonline\\.com|ibasemaps-api\\.arcgis\\.com)\\/arcgis\\/rest\\/services\\/([^\\/]+(\\/[^\\/]+)*)\\/mapserver/i);return r&&r[2]}_getDefaultAttribution(e){if(!e)return;let r;e=e.toLowerCase();for(let t=0,s=M.length;t<s;t++)if(r=M[t],r.toLowerCase().indexOf(e)>-1)return c(\"//static.arcgis.com/attribution/\"+r)}_getDefaultTileServers(e){const r=-1!==e.search(/^(?:https?:)?\\/\\/server\\.arcgisonline\\.com/i),t=-1!==e.search(/^(?:https?:)?\\/\\/services\\.arcgisonline\\.com/i);return r||t?[e,e.replace(r?/server\\.arcgisonline/i:/services\\.arcgisonline/i,r?\"services.arcgisonline\":\"server.arcgisonline\")]:[]}};e([t({readOnly:!0,dependsOn:[\"parsedUrl\"]})],N.prototype,\"attributionDataUrl\",null),e([t({type:[\"show\",\"hide\",\"hide-children\"]})],N.prototype,\"listMode\",void 0),e([t({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],N.prototype,\"isReference\",void 0),e([t({readOnly:!0,type:[\"ArcGISTiledMapServiceLayer\"]})],N.prototype,\"operationalLayerType\",void 0),e([t({type:Boolean})],N.prototype,\"resampling\",void 0),e([t()],N.prototype,\"sourceJSON\",void 0),e([t({type:h})],N.prototype,\"spatialReference\",void 0),e([o(\"spatialReference\",[\"spatialReference\",\"tileInfo\"])],N.prototype,\"readSpatialReference\",null),e([t({type:String,json:{origins:{\"web-scene\":{read:!0,write:!0}},read:!1}})],N.prototype,\"path\",void 0),e([t({readOnly:!0})],N.prototype,\"sublayers\",void 0),e([a(\"sublayers\",{layers:{type:[C]}})],N.prototype,\"writeSublayers\",null),e([t({json:{read:!1,write:!1}})],N.prototype,\"popupEnabled\",void 0),e([t({dependsOn:[\"parsedUrl\"]})],N.prototype,\"tileServers\",null),e([s(\"tileServers\")],N.prototype,\"castTileServers\",null),e([t({readOnly:!0,json:{read:!1}})],N.prototype,\"type\",void 0),e([t(j)],N.prototype,\"url\",void 0),N=e([i(\"esri.layers.TileLayer\")],N);var P=N;export default P;\n"],"sourceRoot":""}
{"version":3,"sources":["webpack://inspection-scheduler/./node_modules/@arcgis/core/layers/support/ExportImageParameters.js","webpack://inspection-scheduler/./node_modules/@arcgis/core/layers/support/sublayerUtils.js","webpack://inspection-scheduler/./node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","webpack://inspection-scheduler/./node_modules/@arcgis/core/views/layers/MapImageLayerView.js","webpack://inspection-scheduler/./node_modules/@arcgis/core/views/2d/layers/MapImageLayerView2D.js","webpack://inspection-scheduler/./node_modules/@arcgis/core/views/layers/support/popupUtils.js","webpack://inspection-scheduler/./node_modules/@arcgis/core/views/support/drapedUtils.js"],"names":["o","visible","definitionExpression","labelingInfo","labelsVisible","opacity","minScale","maxScale","renderer","source","y","super","arguments","this","_scale","view","layer","hasDynamicLayers","e","visibleSublayers","map","toExportImageJSON","length","JSON","stringify","serviceSublayers","_get","_set","handles","remove","add","allSublayers","on","notifyChange","propertyName","id","join","filter","reduce","s","scale","layers","layerDefs","dynamicLayers","timeExtent","dpi","imageFormat","imageTransparency","gdbVersion","sublayers","r","i","a","t","l","forEach","unshift","some","format","transparent","readOnly","dependsOn","prototype","type","Number","n","flatten","originIdOf","mapLayerId","slice","reverse","toArray","layerDefinition","xoffset","Math","max","abs","yoffset","stops","size","event","pointerType","maxSize","minSize","f","floor","visualVariables","symbol","uniqueValueInfos","classBreakInfos","d","u","get","async","popupEnabled","defaultPopupTemplateEnabled","push","sublayer","popupTemplate","load","catch","createQuery","p","createFetchPopupFeaturesQueryGeometry","geometry","outFields","m","_loadArcadeModules","arcadeUtils","hasGeometryOperations","maxAllowableOffset","width","queryFeatures","features","value","canResume","imageParameters","isEmpty","c","_exportImageVersion","strategy","update","error","imageMaxWidth","imageMaxHeight","version","_bitmapContainer","container","addChild","fetchSource","fetchImage","bind","requestUpdate","imageRotationSupported","imageNormalizationSupported","hidpi","destroy","removeChild","removeAllChildren","updating","updateRequested","timestamp","refreshTimestamp","getRequiredFields","fields","lastEditInfoEnabled","objectIdField","typeIdField","globalIdField","relationships","includes","indexOf","keyField","defaultPopupTemplate","resolution","overlayPixelSizeInMapUnits","basemapSpatialReference","equals","spatialReference","x","xmin","min","ymin","xmax","ymax"],"mappings":"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","file":"chunks/4005.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as r}from\"../../core/accessorSupport/decorators/subclass.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import i from\"../../core/Accessor.js\";import{combinedViewLayerTimeExtentProperty as a}from\"./commonProperties.js\";import{HandleOwnerMixin as t}from\"../../core/HandleOwner.js\";import{isExportDynamic as l}from\"./sublayerUtils.js\";import n from\"../../views/View.js\";const o={visible:\"visibleSublayers\",definitionExpression:\"layerDefs\",labelingInfo:\"hasDynamicLayers\",labelsVisible:\"hasDynamicLayers\",opacity:\"hasDynamicLayers\",minScale:\"visibleSublayers\",maxScale:\"visibleSublayers\",renderer:\"hasDynamicLayers\",source:\"hasDynamicLayers\"};let y=class extends(t(i)){constructor(){super(...arguments),this._scale=null,this.view=null}destroy(){this.layer=this.view=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map((e=>e.toExportImageJSON()));return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&l(this.visibleSublayers,this.layer.serviceSublayers,this.layer)}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.handles.remove(\"layer\"),e&&this.handles.add([e.allSublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"sublayer-update\",(e=>this.notifyChange(o[e.propertyName])))],\"layer\"))}get layers(){const e=this.visibleSublayers;return e?e.length?\"show:\"+e.map((e=>e.id)).join(\",\"):\"show:-1\":null}get layerDefs(){const e=this.visibleSublayers.filter((e=>null!=e.definitionExpression));return e.length?JSON.stringify(e.reduce(((e,s)=>(e[s.id]=s.definitionExpression,e)),{})):null}get scale(){return null!=this._scale?this._scale:this.view&&this.view.scale||0}set scale(e){this.view||(this._scale=e,this.notifyChange(\"scale\"))}get version(){const e=this;e.layers,e.layerDefs,e.dynamicLayers,e.timeExtent;const s=e.layer;return s&&(s.dpi,s.imageFormat,s.imageTransparency,s.gdbVersion),(this._get(\"version\")||0)+1}set version(e){this._set(\"version\",e)}get visibleSublayers(){const e=[];if(!this.layer)return e;const s=this.layer.sublayers,r=s=>{const i=this.scale,a=0===i,t=0===s.minScale||i<=s.minScale,l=0===s.maxScale||i>=s.maxScale;s.visible&&(a||t&&l)&&(s.sublayers?s.sublayers.forEach(r):e.unshift(s))};s&&s.forEach(r);const i=this._get(\"visibleSublayers\");return!i||i.length!==e.length||i.some(((s,r)=>e[r]!==s))?e:i}toJSON(){const e=this.layer;let s={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?s.dynamicLayers=this.dynamicLayers:s={...s,layers:this.layers,layerDefs:this.layerDefs},s}};e([s({readOnly:!0,dependsOn:[\"hasDynamicLayers\",\"visibleSublayers\"]})],y.prototype,\"dynamicLayers\",null),e([s({readOnly:!0,dependsOn:[\"visibleSublayers\",\"layer.serviceSublayers\",\"layer.capabilities\"]})],y.prototype,\"hasDynamicLayers\",null),e([s()],y.prototype,\"layer\",null),e([s({readOnly:!0,dependsOn:[\"visibleSublayers\"]})],y.prototype,\"layers\",null),e([s({readOnly:!0,dependsOn:[\"visibleSublayers\"]})],y.prototype,\"layerDefs\",null),e([s({type:Number,dependsOn:[\"view.scale\"]})],y.prototype,\"scale\",null),e([s(a)],y.prototype,\"timeExtent\",void 0),e([s({dependsOn:[\"layers\",\"layerDefs\",\"dynamicLayers\",\"layer.dpi\",\"layer.imageFormat\",\"layer.imageTransparency\",\"layer.gdbVersion\",\"timeExtent\"]})],y.prototype,\"version\",null),e([s({type:n})],y.prototype,\"view\",void 0),e([s({readOnly:!0,dependsOn:[\"layer.sublayers\",\"scale\"]})],y.prototype,\"visibleSublayers\",null),y=e([r(\"esri.layers.mixins.ExportImageParameters\")],y);export{y as ExportImageParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction e(e,n,i){if(n.flatten((({sublayers:e})=>e)).length!==e.length)return!0;return!!e.some((e=>e.originIdOf(\"minScale\")>i||e.originIdOf(\"maxScale\")>i||e.originIdOf(\"renderer\")>i||e.originIdOf(\"labelingInfo\")>i||e.originIdOf(\"opacity\")>i||e.originIdOf(\"labelsVisible\")>i||e.originIdOf(\"source\")>i))||!r(e,n)}function n(e,n,i){return!!e.some((e=>{const n=e.source;return!(!n||\"map-layer\"===n.type&&n.mapLayerId===e.id&&(!n.gdbVersion||n.gdbVersion===i.gdbVersion))||e.originIdOf(\"renderer\")>2||e.originIdOf(\"labelingInfo\")>2||e.originIdOf(\"opacity\")>2||e.originIdOf(\"labelsVisible\")>2}))||!r(e,n)}function r(e,n){if(!e||!e.length)return!0;const r=n.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).map((e=>e.id)).toArray();if(e.length>r.length)return!1;let i=0;const o=r.length;for(const{id:n}of e){for(;i<o&&r[i]!==n;)i++;if(i>=o)return!1}return!0}function i(e){return!!e&&e.some((e=>null!=e.minScale||e.layerDefinition&&null!=e.layerDefinition.minScale))}export{n as isExportDynamic,i as isSublayerOverhaul,e as shouldWriteSublayerStructure};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t,e){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?function(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}(t.stops):e}function n(n){const r=n&&n.renderer,s=\"touch\"===(n&&n.event&&n.event.pointerType)?9:6;if(!r)return s;const o=\"visualVariables\"in r?function(t,n){if(!n)return t;const r=n.filter((t=>\"size\"===t.type)).map((n=>{const{maxSize:r,minSize:s}=n;return(e(r,t)+e(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let t=0;t<o;t++)s+=r[t];const f=Math.floor(s/o);return Math.max(f,t)}(s,r.visualVariables):s;if(\"simple\"===r.type)return t(o,r.symbol);if(\"unique-value\"===r.type){let e=o;return r.uniqueValueInfos.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===r.type){let e=o;return r.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return r.type,o}export{n as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import{isSome as r}from\"../../core/maybe.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import o from\"../../core/Error.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import{reject as a,all as p,eachAlways as i}from\"../../core/promiseUtils.js\";import{loadArcade as u}from\"../../support/arcadeOnDemand.js\";import{calculateTolerance as c}from\"../../renderers/support/clickToleranceUtils.js\";import{getRequiredFields as l,getFetchPopupTemplate as m}from\"./support/popupUtils.js\";const n=n=>{let d=class extends n{async fetchPopupFeatures(e,t){const{layer:s}=this;if(!e)return a(new o(\"mapimagelayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s}));const u=this.get(\"view.scale\"),n=[],d=async e=>{const s=0===e.minScale||u<=e.minScale,o=0===e.maxScale||u>=e.maxScale;if(e.visible&&s&&o)if(e.sublayers)e.sublayers.forEach(d);else if(e.popupEnabled){const s=m(e,{...t,defaultPopupTemplateEnabled:!1});r(s)&&n.push({sublayer:e,popupTemplate:s})}},y=s.sublayers.toArray().map(d);await p(y);const f=n.map((async({sublayer:s,popupTemplate:o})=>{await s.load().catch((()=>{}));const a=s.createQuery(),p=r(t)?t.event:null,i=c({renderer:s.renderer,event:p}),u=this.createFetchPopupFeaturesQueryGeometry(e,i);a.geometry=u,a.outFields=await l(s,o);const m=await this._loadArcadeModules(o);m&&m.arcadeUtils.hasGeometryOperations(o)||(a.maxAllowableOffset=u.width/i);return(await s.queryFeatures(a)).features}));return(await i(f)).reduce(((e,r)=>r.value?[...e,...r.value]:e),[]).filter((e=>null!=e))}canResume(){var e,r;return!!super.canResume()&&(null==(e=this.imageParameters)||null==(r=e.timeExtent)||!r.isEmpty)}_loadArcadeModules(e){if(e.get(\"expressionInfos.length\"))return u()}};return e([t()],d.prototype,\"imageParameters\",void 0),e([t()],d.prototype,\"layer\",void 0),e([t({dependsOn:[\"imageParameters.timeExtent\"]})],d.prototype,\"suspended\",void 0),d=e([s(\"esri.views.layers.MapImageLayerView\")],d),d};export{n as MapImageLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import t from\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{isAbortError as s}from\"../../../core/promiseUtils.js\";import{init as a}from\"../../../core/watchUtils.js\";import{RefreshableLayerView as o}from\"../../layers/RefreshableLayerView.js\";import{ExportImageParameters as p}from\"../../../layers/support/ExportImageParameters.js\";import m from\"../../layers/LayerView.js\";import{createQueryGeometry as h}from\"../../support/drapedUtils.js\";import{MapImageLayerView as n}from\"../../layers/MapImageLayerView.js\";import{BitmapContainer as d}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as g}from\"./LayerView2D.js\";import u from\"./support/ExportStrategy.js\";const c=t.getLogger(\"esri.views.2d.layers.MapImageLayerView2D\");let l=class extends(n(o(g(m)))){constructor(){super(...arguments),this._exportImageVersion=-1}hitTest(){return null}update(e){this.strategy.update(e).catch((e=>{s(e)||c.error(e)}))}attach(){const{imageMaxWidth:e,imageMaxHeight:t,version:r}=this.layer,i=r>=10.3,s=r>=10;this._bitmapContainer=new d,this.container.addChild(this._bitmapContainer),this.strategy=new u({container:this._bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:e,imageMaxHeight:t,imageRotationSupported:i,imageNormalizationSupported:s,hidpi:!0}),this.imageParameters=new p({view:this.view,layer:this.layer}),this.handles.add(a(this.imageParameters,\"version\",(e=>{this._exportImageVersion!==e&&(this._exportImageVersion=e,this.requestUpdate())})),\"mapimagelayerview-update\")}detach(){this.strategy.destroy(),this.handles.remove(\"mapimagelayerview-update\"),this.imageParameters.destroy(),this.imageParameters=null,this._exportImageVersion=-1,this.container.removeChild(this._bitmapContainer),this._bitmapContainer.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQueryGeometry(e,t){return h(e,t,this.view)}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,r,i){return this.layer.fetchImage(e,t,r,{timeExtent:this.imageParameters.timeExtent,timestamp:this.refreshTimestamp,...i})}};e([r()],l.prototype,\"strategy\",void 0),e([r({dependsOn:[\"strategy.updating\"]})],l.prototype,\"updating\",void 0),l=e([i(\"esri.views.2d.layers.MapImageLayerView2D\")],l);var y=l;export default y;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as l,hasField as t}from\"../../../layers/support/fieldUtils.js\";async function i(i,d=i.popupTemplate){if(!e(d))return[];const o=await d.getRequiredFields(i.fields),{lastEditInfoEnabled:s}=d,{objectIdField:u,typeIdField:a,globalIdField:n,relationships:f}=i;if(o.includes(\"*\"))return[\"*\"];const r=s?await p(i):[],m=l(i.fields,[...o,...r]);return a&&m.push(a),m&&u&&t(i.fields,u)&&-1===m.indexOf(u)&&m.push(u),m&&n&&t(i.fields,n)&&-1===m.indexOf(n)&&m.push(n),f&&f.forEach((e=>{const{keyField:p}=e;m&&p&&t(i.fields,p)&&-1===m.indexOf(p)&&m.push(p)})),m}function d(p,l){return p.popupTemplate?p.popupTemplate:e(l)&&l.defaultPopupTemplateEnabled&&e(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}export{d as getFetchPopupTemplate,i as getRequiredFields};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../core/maybe.js\";import r from\"../../geometry/Extent.js\";import\"../../geometry.js\";import{getMetersPerUnitForSR as n}from\"../../core/unitUtils.js\";import{calculateTolerance as i}from\"../../renderers/support/clickToleranceUtils.js\";function a(t,i,a,o=new r){let s;if(\"2d\"===a.type)s=i*a.resolution;else if(\"3d\"===a.type){const r=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?n(o)/n(a.spatialReference):i*r}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,n){const o=n.toMap(e);if(t(o))return!1;return a(o,i(),n,s).intersects(r)}const s=new r;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n"],"sourceRoot":""}